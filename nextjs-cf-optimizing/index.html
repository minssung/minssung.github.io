<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.7"/><meta name="description" content="ëª©ì°¨ ê°œìš” ë¹Œë“œ í´ë” êµ¬ì¡° next.config.js ì„¤ì • assetPrefix, standalone ì„¤ì • CI/CD ì„¤ì • ì •ì  íŒŒì¼ì„ S3ì— ì—…ë¡œë“œí•˜ê¸° ë²ˆë“¤ íŒ¨í‚¤ì§• ë²ˆë“¤ íŒŒì¼ì„ S3ì— ì—…ë¡œë“œ EB ì•± ë²„ì „ ë“±ë¡ EB í™˜ê²½ ì—…ë°ì´íŠ¸ CloudFrontâ€¦" data-gatsby-head="true"/><meta name="image" content="https://minssung.github.io/static/7b6b3f3126c064a93c5299dccf5566d4/c7240/nextjs-cf-optimizing-thumbnail.png" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="Next.js ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ S3 + CloudFrontë¡œ ì„œë¹™í•˜ê¸°: ë¹„ìš© ìµœì í™”" data-gatsby-head="true"/><meta name="twitter:url" content="https://minssung.github.io" data-gatsby-head="true"/><meta name="twitter:description" content="ëª©ì°¨ ê°œìš” ë¹Œë“œ í´ë” êµ¬ì¡° next.config.js ì„¤ì • assetPrefix, standalone ì„¤ì • CI/CD ì„¤ì • ì •ì  íŒŒì¼ì„ S3ì— ì—…ë¡œë“œí•˜ê¸° ë²ˆë“¤ íŒ¨í‚¤ì§• ë²ˆë“¤ íŒŒì¼ì„ S3ì— ì—…ë¡œë“œ EB ì•± ë²„ì „ ë“±ë¡ EB í™˜ê²½ ì—…ë°ì´íŠ¸ CloudFrontâ€¦" data-gatsby-head="true"/><meta name="twitter:image" content="https://minssung.github.io/static/7b6b3f3126c064a93c5299dccf5566d4/c7240/nextjs-cf-optimizing-thumbnail.png" data-gatsby-head="true"/><meta property="og:title" content="Next.js ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ S3 + CloudFrontë¡œ ì„œë¹™í•˜ê¸°: ë¹„ìš© ìµœì í™”" data-gatsby-head="true"/><meta property="og:url" content="https://minssung.github.io" data-gatsby-head="true"/><meta property="og:description" content="ëª©ì°¨ ê°œìš” ë¹Œë“œ í´ë” êµ¬ì¡° next.config.js ì„¤ì • assetPrefix, standalone ì„¤ì • CI/CD ì„¤ì • ì •ì  íŒŒì¼ì„ S3ì— ì—…ë¡œë“œí•˜ê¸° ë²ˆë“¤ íŒ¨í‚¤ì§• ë²ˆë“¤ íŒŒì¼ì„ S3ì— ì—…ë¡œë“œ EB ì•± ë²„ì „ ë“±ë¡ EB í™˜ê²½ ì—…ë°ì´íŠ¸ CloudFrontâ€¦" data-gatsby-head="true"/><meta property="og:image" content="https://minssung.github.io/static/7b6b3f3126c064a93c5299dccf5566d4/c7240/nextjs-cf-optimizing-thumbnail.png" data-gatsby-head="true"/><meta property="og:type" content="article" data-gatsby-head="true"/><meta property="og:site_name" content="min.log" data-gatsby-head="true"/><style data-href="/styles.1ced7485db79a1becc54.css" data-identity="gatsby-global-css">:root{--bg-color:#fef7f7;--text-color:#000;--dimmed-light-color:#f0f0f0;--dimmed-dark-color:#333;--blockquote-border:#27a9e3;--blockquote-bg:#f8fcff;--link-color:#06c;--code-bg-color:#d4d4d4;--box-shadow-color:rgba(0,0,0,.2);--logo-bg-color:#efefef}[data-theme=dark]{--bg-color:#222;--text-color:#ddd;--dimmed-light-color:#333;--dimmed-dark-color:#ccc;--blockquote-border:#1a8fc7;--blockquote-bg:#1a1a1a;--link-color:#66b3ff;--code-bg-color:#2f2f2f;--box-shadow-color:hsla(0,0%,100%,.8);--logo-bg-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:Noto Sans KR,sans-serif;margin:0;transition:background-color .2s,color .2s}img{height:auto;max-width:100%}blockquote{background-color:var(--blockquote-bg);border:none;border-left:5px solid var(--blockquote-border);border-radius:0 8px 8px 0;box-shadow:0 2px 4px rgba(39,169,227,.1);margin:1.5em 0;padding:1.5em 2em;position:relative;transition:all .3s ease}blockquote:before{color:rgba(39,169,227,.2);content:'"';font-family:Georgia,serif;font-size:4em;left:10px;position:absolute;top:-10px}blockquote:hover{background-color:var(--blockquote-bg);box-shadow:0 4px 8px rgba(39,169,227,.15);transform:translateX(5px)}p{line-height:1.6}p img{display:flex;justify-self:center}p+#caption{margin-top:-1rem}h2{margin-top:0}h3{margin-bottom:1.25rem;margin-top:2rem}a{color:var(--link-color);text-decoration:none}code:not(:has(*)){background-color:var(--code-bg-color);border-radius:3px;color:#ff4141;font-family:Fira Code,monospace;font-size:.9em;padding:.1rem .3rem}table{border-collapse:collapse;width:100%}th{padding:6px;text-align:left}td,th{border:1px solid gray}td{padding:4px}hr{margin-bottom:2rem;margin-top:2rem}ul ul{padding:5px 10px}#___gatsby{display:flex;height:100%;justify-content:center}#gatsby-focus-wrapper{display:flex;flex-direction:column;max-width:600px;width:100%}#caption{color:#666;font-size:.8rem;text-align:center}</style><style data-styled="" data-styled-version="6.1.13">.hQYLxw{display:inline-block;vertical-align:middle;overflow:hidden;}/*!sc*/
data-styled.g1[id="StyledIconBase-sc-ea9ulj-0"]{content:"hQYLxw,"}/*!sc*/
.jfXrfb{display:flex;align-items:center;padding:12px 20px;position:sticky;top:0;background-color:var(--bg-color);box-shadow:0 0 4px var(--box-shadow-color);opacity:0.9;z-index:100;transition:background-color 0.3s cubic-bezier(0.4,0,0.2,1) 0ms;}/*!sc*/
data-styled.g2[id="header__StyledHeader-sc-1k96c9s-0"]{content:"jfXrfb,"}/*!sc*/
.gTAlhq{color:var(--text-color);padding:8px;background-color:transparent;border:none;border-radius:50%;cursor:pointer;user-select:none;transition:background-color 0.3s cubic-bezier(0.4,0,0.2,1) 0ms;}/*!sc*/
.gTAlhq:hover{background-color:var(--dimmed-light-color);transition:0.3s;}/*!sc*/
data-styled.g3[id="header__IconButton-sc-1k96c9s-1"]{content:"gTAlhq,"}/*!sc*/
.icbpJb{display:flex;align-items:center;color:inherit;border:1px solid rgba(0,0,0,0.1);border-radius:16px;background-color:var(--logo-bg-color);padding:5px 10px;transition:all 0.2s ease-in-out;}/*!sc*/
.icbpJb:hover{background-color:var(--logo-bg-color);transform:translateY(-1px);box-shadow:0 0 8px var(--box-shadow-color);}/*!sc*/
.icbpJb:active{transform:translateY(0);box-shadow:none;}/*!sc*/
data-styled.g4[id="header__StyledLink-sc-1k96c9s-2"]{content:"icbpJb,"}/*!sc*/
.coBtgC{flex-grow:1;padding:40px;box-shadow:0 0 4px 0 var(--box-shadow-color);}/*!sc*/
data-styled.g5[id="layout__Main-sc-wcovtc-0"]{content:"coBtgC,"}/*!sc*/
</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sunflower:wght@300;500;700&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&amp;display=swap"/><title data-gatsby-head="true">Next.js ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ S3 + CloudFrontë¡œ ì„œë¹™í•˜ê¸°: ë¹„ìš© ìµœì í™”</title><link rel="canonical" href="https://minssung.github.io" data-gatsby-head="true"/></head><body><script>
          (function() {
            function getInitialColorMode() {
              const persistedColorPreference = window.localStorage.getItem('theme');
              const hasPersistedPreference = typeof persistedColorPreference === 'string';
              if (hasPersistedPreference) {
                return persistedColorPreference;
              }
              const mql = window.matchMedia('(prefers-color-scheme: dark)');
              const hasMediaQueryPreference = typeof mql.matches === 'boolean';
              if (hasMediaQueryPreference) {
                return mql.matches ? 'dark' : 'light';
              }
              return 'light';
            }
            const colorMode = getInitialColorMode();
            document.documentElement.setAttribute('data-theme', colorMode);
          })()
        </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="header__StyledHeader-sc-1k96c9s-0 jfXrfb"><div style="display:flex;justify-content:space-between;align-items:center;width:100%"><div style="display:flex;align-items:center"><a class="header__StyledLink-sc-1k96c9s-2 icbpJb" href="/"><img src="/favicon.ico" style="width:24px;height:24px;border-radius:16px"/><h3 style="margin:0;margin-left:4px">min.log</h3></a></div><div><button class="header__IconButton-sc-1k96c9s-1 gTAlhq"><svg viewBox="0 0 24 24" height="24" width="24" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-sc-ea9ulj-0 hQYLxw"><path d="M9.37 5.51A7.35 7.35 0 0 0 9.1 7.5c0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27A7.014 7.014 0 0 1 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"></path></svg></button><button class="header__IconButton-sc-1k96c9s-1 gTAlhq"><svg viewBox="0 0 24 24" height="24" width="24" aria-hidden="true" focusable="false" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="StyledIconBase-sc-ea9ulj-0 hQYLxw"><path fill-rule="evenodd" d="M12.026 2c-5.509 0-9.974 4.465-9.974 9.974 0 4.406 2.857 8.145 6.821 9.465.499.09.679-.217.679-.481 0-.237-.008-.865-.011-1.696-2.775.602-3.361-1.338-3.361-1.338-.452-1.152-1.107-1.459-1.107-1.459-.905-.619.069-.605.069-.605 1.002.07 1.527 1.028 1.527 1.028.89 1.524 2.336 1.084 2.902.829.091-.645.351-1.085.635-1.334-2.214-.251-4.542-1.107-4.542-4.93 0-1.087.389-1.979 1.024-2.675-.101-.253-.446-1.268.099-2.64 0 0 .837-.269 2.742 1.021a9.582 9.582 0 0 1 2.496-.336 9.554 9.554 0 0 1 2.496.336c1.906-1.291 2.742-1.021 2.742-1.021.545 1.372.203 2.387.099 2.64.64.696 1.024 1.587 1.024 2.675 0 3.833-2.33 4.675-4.552 4.922.355.308.675.916.675 1.846 0 1.334-.012 2.41-.012 2.737 0 .267.178.577.687.479C19.146 20.115 22 16.379 22 11.974 22 6.465 17.535 2 12.026 2z" clip-rule="evenodd"></path></svg></button></div></div></div><main class="layout__Main-sc-wcovtc-0 coBtgC"><div class="blog-post"><h2>Next.js ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ S3 + CloudFrontë¡œ ì„œë¹™í•˜ê¸°: ë¹„ìš© ìµœì í™”</h2><div class="blog-post-content"><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7b6b3f3126c064a93c5299dccf5566d4/42a19/nextjs-cf-optimizing-thumbnail.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACsUlEQVR42o1UPW/TQBjOr2BGDOyM7AxsDEz8ACTmLiwFiYkJCQmpQmJBCImqQpUQVEVK25C0idM2NkkbJaV2nDhOHPtyd/b5I7Edp+V13AbTD4H06PTenZ97n/fLGUqGlM5AztergZhtm7ZDKZ4fZv5cX88k2GCOc7D+QV17ZTGTYpQi0xSf/r1NyEPdDcLs0mLuyS16mKXMpthIkS8gJQfcEoIHXTn/4oG09AjrKsaIzJyfySazqOY2SWkGlSPPsQjaff2YrD4dB4FrW8wihKBMcm2ZJI3EOTzPGJVlKZfbFKpVjuOKW995ns/nf7SkY2bRDHwX+O50Mo7CUTSJMY3GcBILJgge0vqqIPCNeq1+UKvwlfphVfjJd7sduMqA22kUAE5PJyfTIMEkHJnnJQHDdSw/9HtaHw8NPwxgC25BVwYeGHksCDyTDkee3espYEwj3zIhFmwCIAQTI+lX5eVz/tmC1jiAUp8lzHUYBNBs1qtVCGcf1k5biibjfq8ry6LSkcWjhsGso3dvdu7c/HT7xt7ighNNCBrEZMsijm2q3Q7w9UEP4sRQVcguRvqgrxsDrdeFL5S11drDe7n7d5vv37qBT5Aek0EYiISYIUkn0zCJfxKOY80UJ4UwdK2jtIUvn5srHyVZAlFJRuJsh4F3EvmQJ8gzpB3swPfmdQayqirF4nahVNwVhDJXEo+PzhI2u8awgbrP1hhmqvtnwJ7L+qpsDBQw5rfzwUAkhctzAn6qe1qlqGGE5r14qbfJxfEEms2GYgNtfR1+W0YCZ9g29PaFkbwGEIXnmUqL7GTJ+gptVuloZMLhf5HbckvptHuqwhXEwqbYksRWS4T2hG7LXP0nSA1muVzKbmS3t/O12j5XLmxsZEulIiQf6vdvz45teZ4NjWgzE1bPjW2ASfFvaUY0lQJawaoAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Next.js ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ S3 + CloudFrontë¡œ ì„œë¹™í•˜ê¸°"
        title=""
        src="/static/7b6b3f3126c064a93c5299dccf5566d4/dface/nextjs-cf-optimizing-thumbnail.png"
        srcset="/static/7b6b3f3126c064a93c5299dccf5566d4/a9205/nextjs-cf-optimizing-thumbnail.png 150w,
/static/7b6b3f3126c064a93c5299dccf5566d4/a8a0d/nextjs-cf-optimizing-thumbnail.png 300w,
/static/7b6b3f3126c064a93c5299dccf5566d4/dface/nextjs-cf-optimizing-thumbnail.png 600w,
/static/7b6b3f3126c064a93c5299dccf5566d4/e7448/nextjs-cf-optimizing-thumbnail.png 900w,
/static/7b6b3f3126c064a93c5299dccf5566d4/42a19/nextjs-cf-optimizing-thumbnail.png 1024w"
        sizes="(max-width: 600px) 100vw, 600px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<h3>ëª©ì°¨</h3>
<ul>
<li><a href="#%EA%B0%9C%EC%9A%94">ê°œìš”</a></li>
<li><a href="#%EB%B9%8C%EB%93%9C-%ED%8F%B4%EB%8D%94-%EA%B5%AC%EC%A1%B0">ë¹Œë“œ í´ë” êµ¬ì¡°</a></li>
<li><a href="#next.config.js-%EC%84%A4%EC%A0%95">next.config.js ì„¤ì •</a>
<ul>
<li><a href="#assetprefix-standalone-%EC%84%A4%EC%A0%95">assetPrefix, standalone ì„¤ì •</a></li>
</ul>
</li>
<li><a href="#ci-cd-%EC%84%A4%EC%A0%95">CI/CD ì„¤ì •</a>
<ul>
<li><a href="#%EC%A0%95%EC%A0%81-%ED%8C%8C%EC%9D%BC%EC%9D%84-s3%EC%97%90-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B8%B0">ì •ì  íŒŒì¼ì„ S3ì— ì—…ë¡œë“œí•˜ê¸°</a></li>
<li><a href="#%EB%B2%88%EB%93%A4-%ED%8C%A8%ED%82%A4%EC%A7%95">ë²ˆë“¤ íŒ¨í‚¤ì§•</a></li>
<li><a href="#%EB%B2%88%EB%93%A4-%ED%8C%8C%EC%9D%BC%EC%9D%84-s3%EC%97%90-%EC%97%85%EB%A1%9C%EB%93%9C">ë²ˆë“¤ íŒŒì¼ì„ S3ì— ì—…ë¡œë“œ</a></li>
<li><a href="#eb-%EC%95%B1-%EB%B2%84%EC%A0%84-%EB%93%B1%EB%A1%9D">EB ì•± ë²„ì „ ë“±ë¡</a></li>
<li><a href="#eb-%ED%99%98%EA%B2%BD-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8">EB í™˜ê²½ ì—…ë°ì´íŠ¸</a></li>
</ul>
</li>
<li><a href="#cloudfront-%EC%BA%90%EC%8B%B1-%EC%84%A4%EC%A0%95">CloudFront ìºì‹± ì„¤ì •</a></li>
<li><a href="#%EC%A0%81%EC%9A%A9-2%EC%A3%BC-%ED%9B%84-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EA%B2%B0%EA%B3%BC">ì ìš© 2ì£¼ í›„ ëª¨ë‹ˆí„°ë§ ê²°ê³¼</a></li>
<li><a href="#%EB%A7%88%EB%AC%B4%EB%A6%AC">ë§ˆë¬´ë¦¬</a>
<ul>
<li><a href="#%ED%95%9C-%EC%A4%84%EC%9D%B4-%EC%95%84%EB%8B%88%EA%B2%8C-%EB%90%9C-%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85">í•œ ì¤„ì´ ì•„ë‹ˆê²Œ ëœ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…</a></li>
</ul>
</li>
</ul>
<h3>ê°œìš” <a id="ê°œìš”"></a></h3>
<p>ì‹¤ë¬´ì—ì„œ <b>EB(Elastic Beanstalk)</b>ë¥¼ í†µí•´ ë°°í¬ë¥¼ í•˜ë©° ìš´ì˜í•˜ë˜ ì¤‘ì— ìµœê·¼, íŠ¸ë˜í”½ì— ë¹„í•´ ë¹„ìš©ì´ ë§ì´ ëŠ˜ì–´ë‚¬ìŒì„ í´ë¼ìš°ë“œ ê´€ë¦¬ìë‹˜ìœ¼ë¡œë¶€í„° ì „ë‹¬ë°›ì•˜ìŠµë‹ˆë‹¤.</p>
<p>ì›ì¸ íŒŒì•…ì„ ì„œë²„ ë‹´ë‹¹ìë¶„ê³¼ ê°™ì´ í•´ë³´ì•˜ìœ¼ë‚˜ í™•ì‹¤í•˜ê²Œ ì¡íˆëŠ” ë¶€ë¶„ì´ ë³´ì´ì§€ ì•Šì•„ ì´ì™€ ë³„ê°œë¡œ ë¹„ìš© ê°œì„ ì„ í•´ì•¼ê² ë‹¤ëŠ” ìƒê°ìœ¼ë¡œ íƒ€ì‚¬(ë°”ë¡œ ì•„ë˜ì¸µ) í”„ë¡ íŠ¸ì—”ë“œ íŒ€ì¥ë‹˜ì˜ ì¡°ì–¸ì„ ì°¸ê³ í•˜ì—¬ ì´ëŸ¬í•œ ë°©ì‹ì„ ë„ì…í–ˆìŠµë‹ˆë‹¤.</p>
<p>ì´ ê¸€ì—ì„œëŠ” ì„œë²„ëŠ” EBê°€ ë‹´ë‹¹í•˜ê³ , ì •ì  íŒŒì¼ì€ S3 + CloudFrontë¡œ ë¶„ë¦¬í•˜ì—¬ ì„œë¹™í•¨ìœ¼ë¡œì¨ ì„±ëŠ¥ê³¼ ë¹„ìš©ì„ ìµœì í™”í•œ ì‚¬ë¡€ë¥¼ ê³µìœ í•©ë‹ˆë‹¤. ë‚´ìš©ì„ ì´í•´í•˜ê¸°ì—” ì¸í”„ë¼ì™€ Github Actionsì— ëŒ€í•œ ê¸°ë³¸ì ì¸ ì´í•´ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
<h3>ë¹Œë“œ í´ë” êµ¬ì¡° <a id="ë¹Œë“œ-í´ë”-êµ¬ì¡°"></a></h3>
<p>Next.js í”„ë¡œì íŠ¸ì—ì„œ ë¹Œë“œ í›„ ìƒì„±ë˜ëŠ” í´ë” êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<pre class="grvsc-container dark-default-dark" data-language="bash" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”œâ”€â”€ .next/</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”‚   â”œâ”€â”€ cache/</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”‚   â”œâ”€â”€ server/</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”‚   â”œâ”€â”€ standalone/</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”‚   â”œâ”€â”€ static/</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”‚   â””â”€â”€ ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”œâ”€â”€ public/</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">â”œâ”€â”€ ...</span></span></span></code></pre>
<p><strong>Next.js 13 ì´í›„</strong>ë¶€í„° <code>next.config.js</code>ì— <code>output: 'standalone'</code>ì„ ì„¤ì •í•˜ë©´, ì„œë²„ ì‹¤í–‰ì— í•„ìš”í•œ ìµœì†Œí•œì˜ íŒŒì¼ì´ .next/standalone/ì— êµ¬ì„±ë˜ê³ , ì •ì  íŒŒì¼ì€ .next/static/ì— ì €ì¥ë©ë‹ˆë‹¤.</p>
<ul>
<li><code>.next/standalone/</code> : EB ì„œë²„ë¡œ ë°°í¬ë˜ëŠ” ì•± ëŸ°íƒ€ì„</li>
<li><code>.next/static/</code>: ì •ì  íŒŒì¼ â†’ S3 + CloudFrontë¡œ ë¶„ë¦¬ ì—…ë¡œë“œ</li>
</ul>
<h3>next.config.js ì„¤ì • <a id="next.config.js-ì„¤ì •"></a></h3>
<h4>assetPrefix, standalone ì„¤ì •</h4>
<p><code>assetPrefix</code>ë¥¼ ì„¤ì •í•˜ì—¬ ì •ì  íŒŒì¼ì„ S3 + CloudFrontì—ì„œ ì„œë¹™í•˜ë„ë¡ í•©ë‹ˆë‹¤. ì´ë•Œ, <code>NEXT_PUBLIC_GIT_COMMIT</code> í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¤ë°‹ í•´ì‹œë¥¼ ê²½ë¡œì— í¬í•¨ì‹œí‚µë‹ˆë‹¤.</p>
<pre class="grvsc-container dark-default-dark" data-language="js" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">// next.config.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">commit</span><span class="mtk1"> = </span><span class="mtk12">process</span><span class="mtk1">.</span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk12">NEXT_PUBLIC_GIT_COMMIT</span><span class="mtk1"> || </span><span class="mtk8">&#39;local&#39;</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk10">module</span><span class="mtk1">.</span><span class="mtk10">exports</span><span class="mtk1"> = {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk12">output:</span><span class="mtk1"> </span><span class="mtk8">&#39;standalone&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk12">assetPrefix:</span><span class="mtk1"> </span><span class="mtk8">`https://xxx.cloudfront.net/</span><span class="mtk4">${</span><span class="mtk12">commit</span><span class="mtk4">}</span><span class="mtk8">`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">};</span></span></span></code></pre>
<blockquote>
<p>ì—¬ê¸°ì„œ ì»¤ë°‹ í•´ì‹œëŠ” GitHub Actionsì—ì„œ ìë™ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì •ì  íŒŒì¼ì˜ ë²„ì „ì„ ê´€ë¦¬í•˜ê³  ìºì‹œ ë¬´íš¨í™”ë¥¼ ì‰½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>
<h3>CI/CD ì„¤ì • <a id="ci-cd-ì„¤ì •"></a></h3>
<p>GitHub Actionsì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¡œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:
(íŠ¸ë¦¬ê±°ë‚˜ install, build ë“±ì€ ìƒëµ)</p>
<h4>ì •ì  íŒŒì¼ì„ S3ì— ì—…ë¡œë“œí•˜ê¸° <a id="ì •ì -íŒŒì¼ì„-s3ì—-ì—…ë¡œë“œí•˜ê¸°"></a></h4>
<pre class="grvsc-container dark-default-dark" data-language="yaml" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Export commit hash</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">run</span><span class="mtk1">: </span><span class="mtk8">echo &quot;NEXT_PUBLIC_GIT_COMMIT=$(git rev-parse --short HEAD)&quot; &gt;&gt; $GITHUB_ENV</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Upload static assets to S3</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">run</span><span class="mtk1">: </span><span class="mtk8">aws s3 sync .next/static s3://my-bucket/static/$NEXT_PUBLIC_GIT_COMMIT --delete</span></span></span></code></pre>
<p>ë°°í¬í•  ë•Œë§ˆë‹¤ ìºì‹œ ë¬´íš¨í™”ë¥¼ í•˜ê¸°ì—ëŠ” ë²ˆê±°ë¡­ê¸°ë„ í•˜ê³ , ì´ì „ ë²„ì „ì˜ íŒŒì¼ì´ S3ì— ë‚¨ì•„ìˆë‹¤ë©´ <strong>ë²„ì „ ë¡¤ë°±ì—ë„ ìš©ì´í•˜ê¸° ë•Œë¬¸ì— ì»¤ë°‹ í•´ì‹œë¥¼ ê²½ë¡œì— í¬í•¨ì‹œì¼œ ê´€ë¦¬</strong>í•©ë‹ˆë‹¤.</p>
<p><code>public/</code> í´ë”ì— ì‚¬ìš© ì¤‘ì¸ ë¦¬ì†ŒìŠ¤ê°€ ë§ë‹¤ë©´ <code>.next/static/</code> í´ë”ì™€ í•¨ê»˜ S3ì— ì—…ë¡œë“œí•˜ê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
<h4>ë²ˆë“¤ íŒ¨í‚¤ì§• <a id="ë²ˆë“¤-íŒ¨í‚¤ì§•"></a></h4>
<pre class="grvsc-container dark-default-dark" data-language="yaml" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Package EB Bundle</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">run</span><span class="mtk1">: </span><span class="mtk15">|</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    mkdir -p eb_bundle</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    cp -r .next node_modules package.json eb_bundle/</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    cp -r public eb_bundle/.next/standalone/public</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    echo &quot;web: node .next/standalone/server.js&quot; &gt; eb_bundle/Procfile</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    cd eb_bundle</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    zip -r ../eb_bundle.zip .</span></span></span></code></pre>
<p>EB ì„œë²„ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ <code>.next/standalone/</code> ë””ë ‰í† ë¦¬ì™€ <code>Procfile</code>ì„ í¬í•¨í•œ ë²ˆë“¤ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
<p>ì €ì˜ ê²½ìš°, public í´ë”ë¥¼ EB ì„œë²„ì—ì„œ ì„œë¹™í•˜ê³  ìˆì–´ <code>.next/standalone/public</code>ì— ë³µì‚¬í•©ë‹ˆë‹¤. ë§Œì•½ S3ë¡œ ì •ì  íŒŒì¼ì„ ëª¨ë‘ ì„œë¹™í•œë‹¤ë©´ ì´ ë‹¨ê³„ëŠ” í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
<p><strong>Procfileì€ EBê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ëŠ” ë°©ë²•ì„ ì •ì˜í•©ë‹ˆë‹¤.</strong> ì—¬ê¸°ì„œëŠ” Node.js ì„œë²„ë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.</p>
<h4>ë²ˆë“¤ íŒŒì¼ì„ S3ì— ì—…ë¡œë“œ <a id="ë²ˆë“¤-íŒŒì¼ì„-s3ì—-ì—…ë¡œë“œ"></a></h4>
<pre class="grvsc-container dark-default-dark" data-language="yaml" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Upload EB Bundle to S3</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">run</span><span class="mtk1">: </span><span class="mtk8">aws s3 cp eb_bundle.zip s3://my-bucket/eb_bundle.zip</span></span></span></code></pre>
<p>S3ì— ë²ˆë“¤ íŒŒì¼ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤. ì´ íŒŒì¼ì€ EBì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
<h4>EB ì•± ë²„ì „ ë“±ë¡ <a id="eb-ì•±-ë²„ì „-ë“±ë¡"></a></h4>
<pre class="grvsc-container dark-default-dark" data-language="yaml" data-index="5"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Register EB Application Version</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">run</span><span class="mtk1">: </span><span class="mtk15">|</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    aws elasticbeanstalk create-application-version \</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">      --application-name my-app \</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">      --version-label $NEXT_PUBLIC_GIT_COMMIT \</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">      --source-bundle S3Bucket=my-bucket,S3Key=eb_bundle.zip</span></span></span></code></pre>
<p>EB ì• í”Œë¦¬ì¼€ì´ì…˜ ë²„ì „ì„ ë“±ë¡í•©ë‹ˆë‹¤. <code>NEXT_PUBLIC_GIT_COMMIT</code>ì„ ë²„ì „ ë ˆì´ë¸”ë¡œ ì‚¬ìš©í•˜ì—¬ ê° ë°°í¬ë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h4>EB í™˜ê²½ ì—…ë°ì´íŠ¸ <a id="eb-í™˜ê²½-ì—…ë°ì´íŠ¸"></a></h4>
<pre class="grvsc-container dark-default-dark" data-language="yaml" data-index="6"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Update EB Environment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">run</span><span class="mtk1">: </span><span class="mtk15">|</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">    aws elasticbeanstalk update-environment \</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">      --environment-name my-env \</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">      --version-label $NEXT_PUBLIC_GIT_COMMIT</span></span></span></code></pre>
<p>EB í™˜ê²½ì„ ì—…ë°ì´íŠ¸í•˜ì—¬ ìƒˆ ë²„ì „ì„ ë°°í¬í•©ë‹ˆë‹¤. ì´ë•Œ, <code>NEXT_PUBLIC_GIT_COMMIT</code>ì„ ì‚¬ìš©í•˜ì—¬ ìµœì‹  ë²„ì „ì„ ì§€ì •í•©ë‹ˆë‹¤.</p>
<h3>CloudFront ìºì‹± ì„¤ì • <a id="cloudfront-ìºì‹±-ì„¤ì •"></a></h3>
<p>ì €ì˜ ê²½ìš°, ì´ë¯¸ CloudFrontë¥¼ ì‚¬ìš© ì¤‘ì´ì—ˆê¸° ë•Œë¬¸ì— S3 ë²„í‚·ë§Œ ì—°ê²°í–ˆìŠµë‹ˆë‹¤.</p>
<p>ë§Œì•½ CloudFrontë¥¼ ì²˜ìŒ ì„¤ì •í•˜ëŠ” ê²½ìš°, <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/GettingStarted.html" target="_blank" rel="noopener noreferrer">AWS CloudFront ê³µì‹ ë¬¸ì„œ</a>ë¥¼ ì°¸ê³ í•˜ì—¬ S3 ë²„í‚·ì„ ì˜¤ë¦¬ì§„ìœ¼ë¡œ ì„¤ì •í•˜ê³ , ìºì‹± ì •ì±…ì„ êµ¬ì„±í•©ë‹ˆë‹¤.
CloudFrontì—ì„œ ì •ì  íŒŒì¼ì„ ìºì‹±í•  ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì„¤ì •ì„ ê¶Œì¥í•©ë‹ˆë‹¤:</p>
<ul>
<li><strong>ìºì‹œ ì •ì±…</strong>: ì •ì  íŒŒì¼ì€ TTL(Time to Live)ì„ ê¸¸ê²Œ ì„¤ì •í•˜ì—¬ ìºì‹œë¥¼ ì˜¤ë˜ ìœ ì§€í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, 1ê°œì›” ì´ìƒ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
<li><strong>ì˜¤ë¦¬ì§„ ìš”ì²­ ì •ì±…</strong>: ì •ì  íŒŒì¼ì€ ì¿¼ë¦¬ ìŠ¤íŠ¸ë§, ì¿ í‚¤ ë“±ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì˜¤ë¦¬ì§„ ìš”ì²­ ì •ì±…ì—ì„œ ì´ë¥¼ ë¹„í™œì„±í™”í•©ë‹ˆë‹¤.</li>
</ul>
<p>ê³µì‹ ë¬¸ì„œ ëŒ€ì‹  <a href="https://velog.io/@rungoat/AWS-S3%EC%99%80-CloudFront-%EC%97%B0%EB%8F%99%ED%95%98%EA%B8%B0" target="_blank" rel="noopener noreferrer">[AWS] S3ì™€ CloudFront ì—°ë™í•˜ê¸°</a> ë¸”ë¡œê·¸ ê¸€ë„ ì¢‹ìŠµë‹ˆë‹¤.</p>
<h3>ì ìš© 2ì£¼ í›„ ëª¨ë‹ˆí„°ë§ ê²°ê³¼ <a id="ì ìš©-2ì£¼-í›„-ëª¨ë‹ˆí„°ë§-ê²°ê³¼"></a></h3>
<p>ìš´ì˜ í™˜ê²½ì— ì ìš©í•œ ì§€ 2ì£¼ê°€ ì§€ë‚œ í›„, EB ì½˜ì†” ëª¨ë‹ˆí„°ë§ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/04e5f86d508373e77389673c9473cdc6/c8ecb/nextjs-cf-optimizing-eb-metrics.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqklEQVR42k1STW/UMBDN//8HnLjAgSMnKtELUouWtkARLFXpJt3dbvPlxIntePyZDS9ZVepo5IxHbz7eixMhpVR6mqbjK8M1xmiMNcYQkdJGao9YGytN5IPnQwhxTJxz/WzCez+OIypRhoasaRhjwzBYa7V1ddtXVSXV0ArqtOcKdT4BFN8QI3A+BMxECzQKIXDedV2/7DGRdeR8zcWhKGJcYJgM6PRiktz4svbJrA/KeASbWp7/Lc7vyh9PvXGBfPQhJnHZ1cVxIMsV+TDGiKZLxrhOaa4t2uWCvu+7m21zeZ//3DW3T12jzMyZty1p0lpbi5IRpxDCWKu0BhdknA9SKSlExZo0TcEGk8ArsWAidM7VerOFNiedG0mtMvfZfv9cnFRAEoEhXZZV08sOg3xIaklgcrYuPt9VWS3znuAfrrZvvjy8X22vM3YiXwqzzsWe0zqXn34/f7w97BqVCHK/Dh38+pGt0nqVNRmTZ3/yd6vHtxebrw9VLQ0c0MuUfcvYxb8SzG92LQPnOCs2i6QXGlBvvs/n0ThPeCcuwOefcjziYSAz45eS/2r2Nbr0e558AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="EB ëª¨ë‹ˆí„°ë§ ê²°ê³¼"
        title=""
        src="/static/04e5f86d508373e77389673c9473cdc6/dface/nextjs-cf-optimizing-eb-metrics.png"
        srcset="/static/04e5f86d508373e77389673c9473cdc6/a9205/nextjs-cf-optimizing-eb-metrics.png 150w,
/static/04e5f86d508373e77389673c9473cdc6/a8a0d/nextjs-cf-optimizing-eb-metrics.png 300w,
/static/04e5f86d508373e77389673c9473cdc6/dface/nextjs-cf-optimizing-eb-metrics.png 600w,
/static/04e5f86d508373e77389673c9473cdc6/e7448/nextjs-cf-optimizing-eb-metrics.png 900w,
/static/04e5f86d508373e77389673c9473cdc6/64756/nextjs-cf-optimizing-eb-metrics.png 1200w,
/static/04e5f86d508373e77389673c9473cdc6/c8ecb/nextjs-cf-optimizing-eb-metrics.png 2978w"
        sizes="(max-width: 600px) 100vw, 600px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<ul>
<li><strong>Request count 2ë°° ì´ìƒ ê°ì†Œ</strong>: ì •ì  ìš”ì²­ì„ EB ì„œë²„ê°€ ì•„ë‹Œ CloudFrontë¡œ ë¶„ë¦¬ ì²˜ë¦¬ â†’ ì„œë²„ ë¶€í•˜ ê°ì†Œ</li>
<li><strong>CPU utilization 2ë°° ì´ìƒ ê°ì†Œ</strong>: ì •ì  íŒŒì¼ ìš”ì²­ ë¶€ë‹´ ì œê±° â†’ ì„œë²„ëŠ” SSR/APIì— ì§‘ì¤‘ â†’ ì¸ìŠ¤í„´ìŠ¤ ìŠ¤í™ ìµœì í™” ê°€ëŠ¥</li>
<li><strong>Network in ëŒ€í­ ê°ì†Œ</strong>: EB ì„œë²„ë¡œ ìœ ì…ë˜ëŠ” ë°ì´í„°ëŸ‰ ê°ì†Œ â†’ ëŒ€ì—­í­ ë¹„ìš© ì ˆê°</li>
<li><strong>Network out 2ë°° ì´ìƒ ì¦ê°€</strong>: ì •ì  íŒŒì¼ ë¶„ë¦¬ í›„ EBëŠ” SSR ìš”ì²­ ì²˜ë¦¬ì— ì§‘ì¤‘ â†’ CloudFrontë¥¼ í†µí•œ ì •ì  íŒŒì¼ ì„œë¹™ìœ¼ë¡œ ì¸í•œ ì¦ê°€</li>
</ul>
<p><strong>ì „ì²´ì ìœ¼ë¡œ ì„œë²„ ë¶€í•˜ê°€ í¬ê²Œ ê°ì†Œí•˜ê³ , ì •ì  íŒŒì¼ ìš”ì²­ì´ CloudFrontë¡œ ë¶„ë¦¬ë˜ì–´ ì„±ëŠ¥ì´ í–¥ìƒ</strong>ë˜ì—ˆìŠµë‹ˆë‹¤. ë˜í•œ, EB ì¸ìŠ¤í„´ìŠ¤ì˜ ìŠ¤í™ì„ ë‚®ì¶°ë„ ì¶©ë¶„íˆ ìš´ì˜ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.</p>
<p>ê·¸ëŸ°ë° Network outì´ ì¦ê°€í•œ ì´ìœ ê°€ ë­˜ê¹Œ ìƒê°í•´ ë´¤ëŠ”ë°.. CloudFrontë¥¼ í†µí•´ ì •ì  íŒŒì¼ì„ ì„œë¹™í•˜ë©´ì„œ ìš©ëŸ‰ì´ ë‚®ì€ ë°ì´í„°ëŠ” CloudFrontê°€ ìºì‹œí•˜ì—¬ ì²˜ë¦¬í•˜ì§€ë§Œ, ìš©ëŸ‰ì´ í° SSR ë°ì´í„°ëŠ” ì—¬ì „íˆ EB ì„œë²„ì—ì„œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” í˜„ìƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤. (ì§€í‘œëŠ” í‰ê·  ê°’)</p>
<h3>ë§ˆë¬´ë¦¬ <a id="ë§ˆë¬´ë¦¬"></a></h3>
<p>ì ìš© ê³¼ì •ì´ ì‰½ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. CI/CD íŒŒì´í”„ë¼ì¸ì„ í†µí•´ ë°°í¬í•œ ê²°ê³¼ë¥¼ í† ëŒ€ë¡œ ìºì‹± ì²˜ë¦¬ë¥¼ í™•ì¸í•´ì•¼ í•˜ëŠ”ë° ë¹Œë“œ &#x26; ì—…ë¡œë“œ &#x26; ë°°í¬ ì‹œê°„ì´ ê±´ë‹¹ 3ë¶„ ì´ìƒ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì—, ë§¤ë²ˆ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ í›„ì— í™•ì¸ê¹Œì§€ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë ¸ìŠµë‹ˆë‹¤.</p>
<p>ì‹¤ì œë¡œ TESTì™€ STAGE í™˜ê²½ì—ì„œ ì›Œí¬í”Œë¡œìš°ë¥¼ í†µí•œ ë°°í¬ê°€ ì•ˆì •í™”ë˜ê¸°ê¹Œì§€ ì—¬ëŸ¬ ë²ˆì˜ ì‹œí–‰ì°©ì˜¤ë¥¼ ê±°ì³¤ìŠµë‹ˆë‹¤. ë•ë¶„ì— PROD í™˜ê²½ì— ì ìš©í•  ë•ŒëŠ” ë¡¤ë°±í•  ì¤€ë¹„ì™€ í•¨ê»˜ ì´ˆì§‘ì¤‘ ëª¨ë‹ˆí„°ë§ì„ í•˜ë©° ë°°í¬ë¥¼ ì§„í–‰í–ˆëŠ”ë° ë‹¤í–‰íˆ ì²« íŠ¸ë¼ì´ì— ì„±ê³µí–ˆë„¤ìš”. ğŸ˜…</p>
<p>ì§„í–‰í•˜ë©´ì„œ ì œê°€ ê²ªì—ˆë˜ ë¬¸ì œì™€ í•´ê²° ë°©ë²•ì„ í•œ ì¤„ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ìœ¼ë¡œ ì •ë¦¬í•˜ë©° ë§ˆë¬´ë¦¬ í•˜ê² ìŠµë‹ˆë‹¤. ì´ ê¸€ì´ ë¹„ìŠ·í•œ ë¬¸ì œë¥¼ ê²ªê³  ìˆëŠ” ë¶„ë“¤ì—ê²Œ ë„ì›€ì´ ë˜ê¸¸ ë°”ëë‹ˆë‹¤.</p>
<h4>í•œ ì¤„ì´ ì•„ë‹ˆê²Œ ëœ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… <a id="í•œ-ì¤„ì´-ì•„ë‹ˆê²Œ-ëœ-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…"></a></h4>
<ul>
<li><strong>ë¬¸ì œ</strong>: <code>Module not found: Can't resolve '@components/layout'</code> ë¹Œë“œ ì—ëŸ¬
<ul>
<li><strong>í•´ê²°</strong>: tsconfig.jsonì—ì„œ ì‚¬ìš©í•˜ë˜ aliasë¥¼ <code>next.config.mjs</code>ì˜ webpack ì„¤ì •ì— ì¶”ê°€í•˜ì—¬ í•´ê²°.</li>
</ul>
<pre class="grvsc-container dark-default-dark" data-language="js" data-index="7"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">// next.config.mjs</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk11">webpack</span><span class="mtk1"> = (</span><span class="mtk12">config</span><span class="mtk1">) </span><span class="mtk4">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">aliases</span><span class="mtk1"> = {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@define&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/define&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@globals&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/globals&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@providers&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/providers&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@components&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/components&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@contexts&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/contexts&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@modules&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/modules&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@widgets&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/widgets&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@state&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/state&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@hooks&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/hooks&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk8">&#39;@api&#39;</span><span class="mtk12">:</span><span class="mtk1"> </span><span class="mtk8">&#39;src/app/api&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      };</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk15">for</span><span class="mtk1"> (</span><span class="mtk4">const</span><span class="mtk1"> [</span><span class="mtk12">alias</span><span class="mtk1">, </span><span class="mtk12">target</span><span class="mtk1">] </span><span class="mtk4">of</span><span class="mtk1"> </span><span class="mtk10">Object</span><span class="mtk1">.</span><span class="mtk11">entries</span><span class="mtk1">(</span><span class="mtk12">aliases</span><span class="mtk1">)) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk12">config</span><span class="mtk1">.</span><span class="mtk12">resolve</span><span class="mtk1">.</span><span class="mtk12">alias</span><span class="mtk1">[</span><span class="mtk12">alias</span><span class="mtk1">] = </span><span class="mtk12">path</span><span class="mtk1">.</span><span class="mtk11">join</span><span class="mtk1">(</span><span class="mtk12">__dirname</span><span class="mtk1">, </span><span class="mtk12">target</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk12">config</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  };</span></span></span></code></pre>
</li>
<li><strong>ë¬¸ì œ</strong>: <code>ReferenceError: __dirname is not defined</code> ë¹Œë“œ ì—ëŸ¬
<ul>
<li><strong>í•´ê²°</strong>: Next.js 13ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ í•˜ë©´ì„œ <code>next.config.js</code>ë¥¼ <code>.mjs</code>(ESM ëª¨ë“ˆ)ë¡œ ì‘ì„±í–ˆëŠ”ë° Node.jsê°€ __dirnameì„ ê¸°ë³¸ ì œê³µí•˜ì§€ ì•Šì•„ì„œ ë°œìƒ. ë‹¤ìŒê³¼ ê°™ì´ importí•˜ì—¬ í•´ê²°.</li>
</ul>
<pre class="grvsc-container dark-default-dark" data-language="js" data-index="8"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk15">import</span><span class="mtk1"> { </span><span class="mtk12">dirname</span><span class="mtk1"> } </span><span class="mtk15">from</span><span class="mtk1"> </span><span class="mtk8">&#39;node:path&#39;</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk15">import</span><span class="mtk1"> { </span><span class="mtk12">fileURLToPath</span><span class="mtk1"> } </span><span class="mtk15">from</span><span class="mtk1"> </span><span class="mtk8">&#39;node:url&#39;</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk12">__dirname</span><span class="mtk1"> = </span><span class="mtk11">dirname</span><span class="mtk1">(</span><span class="mtk11">fileURLToPath</span><span class="mtk1">(</span><span class="mtk15">import</span><span class="mtk1">.</span><span class="mtk12">meta</span><span class="mtk1">.</span><span class="mtk12">url</span><span class="mtk1">));</span></span></span></code></pre>
</li>
<li><strong>ë¬¸ì œ</strong>: <code>Error: Cannot find module 'tailwindcss'</code> ë¹Œë“œ ì—ëŸ¬
<ul>
<li><strong>í•´ê²°</strong>: production í™˜ê²½ì—ì„œ <code>tailwindcss</code>ê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•„ ë°œìƒ. <code>package.json</code>ì— <code>devDependencies</code>ë¡œ ì„¤ì •ë˜ì–´ ìˆì–´, í”„ë¡œë•ì…˜ ë¹Œë“œ ì‹œ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ. ì²˜ìŒ ì„¤ì¹˜ ì‹œì— ê°œë°œ ì˜ì¡´ì„±ë„ ì„¤ì¹˜í•˜ê³ , ì´í›„ì— ê°œë°œ ì˜ì¡´ì„±ì€ ë‹¤ì‹œ ì‚­ì œ.</li>
</ul>
<pre class="grvsc-container dark-default-dark" data-language="yml" data-index="9"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">npm install --production=false</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">npm prune --production</span><span class="mtk1"> </span><span class="mtk3"># ê°œë°œ ì˜ì¡´ì„± ì œê±°</span></span></span></code></pre>
</li>
</ul>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .dark-default-dark {
    background-color: #1E1E1E;
    color: #D4D4D4;
  }
  .dark-default-dark .mtk1 { color: #D4D4D4; }
  .dark-default-dark .mtk3 { color: #6A9955; }
  .dark-default-dark .mtk4 { color: #569CD6; }
  .dark-default-dark .mtk12 { color: #9CDCFE; }
  .dark-default-dark .mtk8 { color: #CE9178; }
  .dark-default-dark .mtk10 { color: #4EC9B0; }
  .dark-default-dark .mtk15 { color: #C586C0; }
  .dark-default-dark .mtk11 { color: #DCDCAA; }
  .dark-default-dark .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div><div></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/nextjs-cf-optimizing";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-75544265ae0962414a84.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-433eae73e1bc7cb0329e.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-9f9960afc14722ee8542.js\"],\"component---src-templates-blog-tsx\":[\"/component---src-templates-blog-tsx-9268609605483cb16307.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="03304920ce4a858d45ba";</script><script src="/webpack-runtime-ee963ce4cfd4a16c112b.js" async></script><script src="/framework-0a5161e04e2410729286.js" async></script><script src="/app-75544265ae0962414a84.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>